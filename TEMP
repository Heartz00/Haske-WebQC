with st.expander("ðŸ§  MRIQC Image Quality Metrics (IQMs) â€“ Full Descriptions"):
    st.markdown("""
## ðŸ§  Anatomical (T1w / T2w) IQMs

**1. CNR â€“ Contrast-to-Noise Ratio**  
Measures how well different tissues (like gray matter and white matter) are distinguished.  
ðŸŸ¢ Higher CNR = better tissue contrast.

**2. SNR â€“ Signal-to-Noise Ratio**  
Assesses the strength of the signal relative to background noise.  
ðŸŸ¢ Higher SNR = cleaner images.

**3. EFC â€“ Entropy Focus Criterion**  
Quantifies image sharpness using Shannon entropy.  
ðŸ”´ Higher EFC = more ghosting or blurring (i.e., less sharp).

**4. FBER â€“ Foreground-Background Energy Ratio**  
Compares energy inside the brain mask vs outside.  
ðŸŸ¢ Higher FBER = better tissue delineation.

**5. FWHM â€“ Full Width at Half Maximum**  
Estimates smoothness in spatial resolution.  
ðŸŸ¡ Lower FWHM = sharper images, but depends on scanner/protocol.

**6. INU â€“ Intensity Non-Uniformity**  
Evaluates bias fields caused by scanner imperfections.  
ðŸ”´ Higher INU = more uneven signal across image.

**7. QI1 â€“ Quality Index 1**  
Measures artifacts in areas outside the brain.  
ðŸ”´ Higher QI1 = more artifacts (e.g., motion, ghosting).

**8. QI2 â€“ Quality Index 2**  
Detects structured noise using chi-squared goodness-of-fit.  
ðŸ”´ Higher QI2 = likely issues with signal consistency.

**9. WM2MAX â€“ White Matter to Max Intensity Ratio**  
Checks if white matter intensity is in a normal range.  
ðŸŸ¡ Very high or low values may indicate poor normalization or acquisition problems.

---

## ðŸ§  Functional (BOLD / fMRI) IQMs

**1. FD â€“ Framewise Displacement**  
Quantifies subject head movement across volumes.  
ðŸ”´ Higher FD = more motion artifacts.  
ðŸŸ¢ Mean FD < 0.2mm is often acceptable.

**2. DVARS â€“ D Temporal Variance of Signal**  
Measures signal change between consecutive volumes.  
ðŸ”´ Spikes in DVARS = potential motion or noise events.

**3. tSNR â€“ Temporal Signal-to-Noise Ratio**  
SNR over time (mean / std of time series per voxel).  
ðŸŸ¢ Higher tSNR = more reliable signal over time.

**4. GCOR â€“ Global Correlation**  
Detects global signal fluctuations across the brain.  
ðŸ”´ High GCOR may indicate widespread noise.

**5. AOR â€“ AFNI Outlier Ratio**  
Counts the number of voxels flagged as statistical outliers.  
ðŸ”´ High AOR = poor scan quality or motion-related issues.

**6. GSR â€“ Global Signal Regression Impact**  
Assesses how removing global signal changes BOLD contrast.  
ðŸŸ¡ Large differences might affect downstream results.

---

ðŸ”Ž **For deeper technical explanations and formulas, see the [MRIQC Documentation](https://mriqc.readthedocs.io/en/stable/iqms/iqms.html).**
""", unsafe_allow_html=True)